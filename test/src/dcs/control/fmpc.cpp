/**
 * \file test/src/dcs/control/fmpc.cpp
 *
 * \brief Test suite for Fast-MPC controllers.
 *
 * \author Marco Guazzone (marco.guazzone@gmail.com)
 *
 * <hr/>
 *
 * Copyright (C) 2012       Marco Guazzone (marco.guazzone@gmail.com)
 *                          [Distributed Computing System (DCS) Group,
 *                           Computer Science Institute,
 *                           Department of Science and Technological Innovation,
 *                           University of Piemonte Orientale,
 *                           Alessandria (Italy)]
 *
 * This file is part of dcsxx-control (below referred to as "this program").
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published
 * by the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program. If not, see <http://www.gnu.org/licenses/>.
 */

#include <boost/numeric/ublas/io.hpp>
#include <boost/numeric/ublas/matrix.hpp>
#include <boost/numeric/ublas/matrix_expression.hpp>
#include <boost/numeric/ublas/matrix_proxy.hpp>
#include <boost/numeric/ublas/vector.hpp>
#include <boost/numeric/ublas/vector_expression.hpp>
#include <boost/numeric/ublas/vector_proxy.hpp>
#include <boost/numeric/ublasx/operation/cat.hpp>
#include <cstddef>
#include <dcs/control/design/fmpc.hpp>
#include <dcs/test.hpp>
#include <iostream>
#include "./utility.hpp"


DCS_TEST_DEF( free_func )
{
	DCS_TEST_CASE("Free Function");

	namespace ublas = ::boost::numeric::ublas;
	namespace ublasx = ::boost::numeric::ublasx;

    /* problem setup */

	typedef double real_type;
	typedef int size_type;
	typedef ublas::matrix<real_type, ublas::column_major> matrix_type;
	typedef ublas::vector<real_type> vector_type;

	const size_type nx = 12;
	const size_type nu = 3;
	const size_type nsteps = 100;

	matrix_type A(nx,nx);
	{
		size_type r;
		size_type c;

		r =  0, c = 0;
		A(r,c++) = 7.6272e-01; A(r,c++) = 1.1488e-01; A(r,c++) = 2.4765e-03; A(r,c++) = 2.0938e-05; A(r,c++) = 9.4223e-08; A(r,c++) = 2.6306e-10; A(r,c++) = 4.5961e-01; A(r,c++) = 1.9813e-02; A(r,c++) = 2.5126e-04; A(r,c++) = 1.5076e-06; A(r,c++) = 5.2612e-09; A(r,c++) = 1.1999e-11;
		r =  1, c = 0;
		A(r,c++) = 1.1488e-01; A(r,c++) = 7.6520e-01; A(r,c++) = 1.1490e-01; A(r,c++) = 2.4766e-03; A(r,c++) = 2.0938e-05; A(r,c++) = 9.4223e-08; A(r,c++) = 1.9813e-02; A(r,c++) = 4.5987e-01; A(r,c++) = 1.9815e-02; A(r,c++) = 2.5127e-04; A(r,c++) = 1.5076e-06; A(r,c++) = 5.2612e-09;
		r =  2, c = 0;
		A(r,c++) = 2.4765e-03; A(r,c++) = 1.1490e-01; A(r,c++) = 7.6520e-01; A(r,c++) = 1.1490e-01; A(r,c++) = 2.4766e-03; A(r,c++) = 2.0938e-05; A(r,c++) = 2.5126e-04; A(r,c++) = 1.9815e-02; A(r,c++) = 4.5987e-01; A(r,c++) = 1.9815e-02; A(r,c++) = 2.5127e-04; A(r,c++) = 1.5076e-06;
		r =  3, c = 0;
		A(r,c++) = 2.0938e-05; A(r,c++) = 2.4766e-03; A(r,c++) = 1.1490e-01; A(r,c++) = 7.6520e-01; A(r,c++) = 1.1490e-01; A(r,c++) = 2.4765e-03; A(r,c++) = 1.5076e-06; A(r,c++) = 2.5127e-04; A(r,c++) = 1.9815e-02; A(r,c++) = 4.5987e-01; A(r,c++) = 1.9815e-02; A(r,c++) = 2.5126e-04;
		r =  4, c = 0;
		A(r,c++) = 9.4223e-08; A(r,c++) = 2.0938e-05; A(r,c++) = 2.4766e-03; A(r,c++) = 1.1490e-01; A(r,c++) = 7.6520e-01; A(r,c++) = 1.1488e-01; A(r,c++) = 5.2612e-09; A(r,c++) = 1.5076e-06; A(r,c++) = 2.5127e-04; A(r,c++) = 1.9815e-02; A(r,c++) = 4.5987e-01; A(r,c++) = 1.9813e-02;
		r =  5, c = 0;
		A(r,c++) = 2.6306e-10; A(r,c++) = 9.4223e-08; A(r,c++) = 2.0938e-05; A(r,c++) = 2.4765e-03; A(r,c++) = 1.1488e-01; A(r,c++) = 7.6272e-01; A(r,c++) = 1.1999e-11; A(r,c++) = 5.2612e-09; A(r,c++) = 1.5076e-06; A(r,c++) = 2.5126e-04; A(r,c++) = 1.9813e-02; A(r,c++) = 4.5961e-01;
		r =  6, c = 0;
		A(r,c++) =-8.9941e-01; A(r,c++) = 4.2024e-01; A(r,c++) = 1.9312e-02; A(r,c++) = 2.4825e-04; A(r,c++) = 1.4971e-06; A(r,c++) = 5.2372e-09; A(r,c++) = 7.6272e-01; A(r,c++) = 1.1488e-01; A(r,c++) = 2.4765e-03; A(r,c++) = 2.0938e-05; A(r,c++) = 9.4223e-08; A(r,c++) = 2.6306e-10;
		r =  7, c = 0;
		A(r,c++) = 4.2024e-01; A(r,c++) =-8.8010e-01; A(r,c++) = 4.2049e-01; A(r,c++) = 1.9314e-02; A(r,c++) = 2.4826e-04; A(r,c++) = 1.4971e-06; A(r,c++) = 1.1488e-01; A(r,c++) = 7.6520e-01; A(r,c++) = 1.1490e-01; A(r,c++) = 2.4766e-03; A(r,c++) = 2.0938e-05; A(r,c++) = 9.4223e-08;
		r =  8, c = 0;
		A(r,c++) = 1.9312e-02; A(r,c++) = 4.2049e-01; A(r,c++) =-8.8010e-01; A(r,c++) = 4.2049e-01; A(r,c++) = 1.9314e-02; A(r,c++) = 2.4825e-04; A(r,c++) = 2.4765e-03; A(r,c++) = 1.1490e-01; A(r,c++) = 7.6520e-01; A(r,c++) = 1.1490e-01; A(r,c++) = 2.4766e-03; A(r,c++) = 2.0938e-05;
		r =  9, c = 0;
		A(r,c++) = 2.4825e-04; A(r,c++) = 1.9314e-02; A(r,c++) = 4.2049e-01; A(r,c++) =-8.8010e-01; A(r,c++) = 4.2049e-01; A(r,c++) = 1.9312e-02; A(r,c++) = 2.0938e-05; A(r,c++) = 2.4766e-03; A(r,c++) = 1.1490e-01; A(r,c++) = 7.6520e-01; A(r,c++) = 1.1490e-01; A(r,c++) = 2.4765e-03;
		r = 10, c = 0;
		A(r,c++) = 1.4971e-06; A(r,c++) = 2.4826e-04; A(r,c++) = 1.9314e-02; A(r,c++) = 4.2049e-01; A(r,c++) =-8.8010e-01; A(r,c++) = 4.2024e-01; A(r,c++) = 9.4223e-08; A(r,c++) = 2.0938e-05; A(r,c++) = 2.4766e-03; A(r,c++) = 1.1490e-01; A(r,c++) = 7.6520e-01; A(r,c++) = 1.1488e-01;
		r = 11, c = 0;
		A(r,c++) = 5.2372e-09; A(r,c++) = 1.4971e-06; A(r,c++) = 2.4825e-04; A(r,c++) = 1.9312e-02; A(r,c++) = 4.2024e-01; A(r,c++) =-8.9941e-01; A(r,c++) = 2.6306e-10; A(r,c++) = 9.4223e-08; A(r,c++) = 2.0938e-05; A(r,c++) = 2.4765e-03; A(r,c++) = 1.1488e-01; A(r,c++) = 7.6272e-01;
	}


//
//A(r,c++) =-0.3348335; A(r,c++) =-0.0284175; A(r,c++) =-0.0632027; A(r,c++) = 0.1016925; A(r,c++) =-0.2566873; A(r,c++) = 0.1077508; A(r,c++) = 0.6492243; A(r,c++) =-0.1333071; A(r,c++) = 0.2439793; A(r,c++) = 0.7718376; A(r,c++) =-0.4974038; A(r,c++) = 0.1209940
//A(r,c++) = 0.2088102; A(r,c++) =-0.0310917; A(r,c++) = 0.2379796; A(r,c++) =-0.1036839; A(r,c++) = 0.6371286; A(r,c++) =-0.0284110; A(r,c++) =-0.0860856; A(r,c++) =-0.1494710; A(r,c++) = 0.0580248; A(r,c++) = 0.0102606; A(r,c++) =-0.0158337; A(r,c++) =-0.2036900
//A(r,c++) =-0.1145483; A(r,c++) = 0.1292763; A(r,c++) = 0.2615429; A(r,c++) = 0.2144771; A(r,c++) =-0.0119147; A(r,c++) = 0.3290591; A(r,c++) = 0.4078635; A(r,c++) =-0.0277792; A(r,c++) = 0.0361168; A(r,c++) =-0.4566963; A(r,c++) =-0.0755472; A(r,c++) = 0.0928260
//A(r,c++) = 0.1379477; A(r,c++) =-0.3913603; A(r,c++) =-0.2806261; A(r,c++) =-0.0815659; A(r,c++) = 0.0935242; A(r,c++) = 0.2101101; A(r,c++) = 0.0044150; A(r,c++) =-0.2115512; A(r,c++) = 0.0886437; A(r,c++) =-0.1172099; A(r,c++) =-0.4759982; A(r,c++) = 0.3133121
//A(r,c++) = 0.1578509; A(r,c++) = 0.1819193; A(r,c++) = 0.2491764; A(r,c++) =-0.2829379; A(r,c++) =-0.0221198; A(r,c++) =-0.1623121; A(r,c++) = 0.1237108; A(r,c++) = 0.0717485; A(r,c++) =-0.0290915; A(r,c++) = 0.4656527; A(r,c++) = 0.0666658; A(r,c++) =-0.1369200
//A(r,c++) = 0.1478784; A(r,c++) =-0.0200370; A(r,c++) =-0.5136189; A(r,c++) =-0.2787899; A(r,c++) = 0.0403804; A(r,c++) =-0.3519817; A(r,c++) =-0.1089885; A(r,c++) = 0.0481487; A(r,c++) = 0.3996247; A(r,c++) = 0.3101364; A(r,c++) = 0.6673644; A(r,c++) = 0.0961400
//A(r,c++) =-0.1646019; A(r,c++) = 0.2070053; A(r,c++) = 0.0291860; A(r,c++) = 0.0599168; A(r,c++) = 0.6533651; A(r,c++) =-0.0452402; A(r,c++) = 0.2095925; A(r,c++) = 0.1405550; A(r,c++) =-0.2760067; A(r,c++) = 0.3321128; A(r,c++) = 0.3576991; A(r,c++) = 0.3434609
//A(r,c++) =-0.0116156; A(r,c++) =-0.2095673; A(r,c++) = 0.5156251; A(r,c++) = 0.4244239; A(r,c++) =-0.0091870; A(r,c++) =-0.3966204; A(r,c++) = 0.0797500; A(r,c++) = 0.2325908; A(r,c++) = 0.1889487; A(r,c++) = 0.0156177; A(r,c++) =-0.1792414; A(r,c++) = 0.0570808
//A(r,c++) = 0.0502684; A(r,c++) =-0.0511950; A(r,c++) =-0.5103361; A(r,c++) = 0.3587348; A(r,c++) =-0.2962217; A(r,c++) = 0.4923480; A(r,c++) = 0.0308246; A(r,c++) =-0.1435624; A(r,c++) = 0.1306456; A(r,c++) = 0.0024575; A(r,c++) = 0.5743270; A(r,c++) =-0.1998096
//A(r,c++) =-0.0180091; A(r,c++) =-0.2121577; A(r,c++) = 0.3266548; A(r,c++) = 0.3826798; A(r,c++) =-0.0488264; A(r,c++) = 0.1047580; A(r,c++) =-0.1450352; A(r,c++) = 0.2917253; A(r,c++) =-0.1385374; A(r,c++) =-0.2545077; A(r,c++) =-0.0608299; A(r,c++) = 0.1744774
//A(r,c++) =-0.0954432; A(r,c++) = 0.1454592; A(r,c++) = 0.3294977; A(r,c++) = 0.0186939; A(r,c++) =-0.4423610; A(r,c++) = 0.0831251; A(r,c++) =-0.5767238; A(r,c++) =-0.0125269; A(r,c++) =-0.1562947; A(r,c++) =-0.2764103; A(r,c++) =-0.2167474; A(r,c++) = 0.0678182
//A(r,c++) = 0.1782933; A(r,c++) = 0.0233594; A(r,c++) = 0.1728577; A(r,c++) =-0.0060443; A(r,c++) = 0.2036175; A(r,c++) =-0.4824848; A(r,c++) = 0.2222103; A(r,c++) = 0.0148148; A(r,c++) =-0.1092411; A(r,c++) = 0.5575757; A(r,c++) =-0.4301168; A(r,c++) =-0.1856023


	matrix_type B(nx,nu);
	{
		size_type r;
		size_type c;

		r =  0; c = 0;
		B(r,c++) = 1.1738e-01; B(r,c++) = 2.1127e-05; B(r,c++) = 9.4750e-08;
		r =  1; c = 0;
		B(r,c++) =-1.1740e-01; B(r,c++) = 2.5187e-03; B(r,c++) = 2.1127e-05;
		r =  2; c = 0;
		B(r,c++) =-2.4977e-03; B(r,c++) = 1.1990e-01; B(r,c++) = 2.5187e-03;
		r =  3; c = 0;
		B(r,c++) =-2.1033e-05; B(r,c++) = 5.0038e-13; B(r,c++) = 1.1990e-01;
		r =  4; c = 0;
		B(r,c++) =-9.4487e-08; B(r,c++) =-1.1990e-01; B(r,c++) = 9.4751e-08;
		r =  5; c = 0;
		B(r,c++) =-2.6356e-10; B(r,c++) =-2.5186e-03; B(r,c++) =-1.1988e-01;
		r =  6; c = 0;
		B(r,c++) = 4.3980e-01; B(r,c++) = 2.5125e-04; B(r,c++) = 1.5076e-06;
		r =  7; c = 0;
		B(r,c++) =-4.4005e-01; B(r,c++) = 1.9813e-02; B(r,c++) = 2.5126e-04;
		r =  8; c = 0;
		B(r,c++) =-1.9563e-02; B(r,c++) = 4.5961e-01; B(r,c++) = 1.9813e-02;
		r =  9; c = 0;
		B(r,c++) =-2.4976e-04; B(r,c++) = 1.1999e-11; B(r,c++) = 4.5961e-01;
		r = 10; c = 0;
		B(r,c++) =-1.5023e-06; B(r,c++) =-4.5961e-01; B(r,c++) = 1.5076e-06;
		r = 11; c = 0;
		B(r,c++) =-5.2492e-09; B(r,c++) =-1.9812e-02; B(r,c++) =-4.5936e-01;
	}


	// process noise trajectory
	matrix_type W(nx, nsteps);
	{
		size_type r;
		size_type c;

		r = 0; c = 0;
		W(r, c++) = 0;                     W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                     W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                     W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                     W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                     W(r, c++) = 0;                    W(r, c++) = 0;                     W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                     W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                     W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                     W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                     W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                     W(r, c++) = 0;                     W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;
		r =  1; c = 0;
		W(r, c++) = 0;                     W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                     W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                     W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                     W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                     W(r, c++) = 0;                    W(r, c++) = 0;                     W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                     W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                     W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                     W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                     W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                     W(r, c++) = 0;                     W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;
		r =  2; c = 0;
		W(r, c++) = 0;                     W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                     W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                     W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                     W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                     W(r, c++) = 0;                    W(r, c++) = 0;                     W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                     W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                     W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                     W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                     W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                     W(r, c++) = 0;                     W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;
		r =  3; c = 0;
		W(r, c++) = 0;                     W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                     W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                     W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                     W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                     W(r, c++) = 0;                    W(r, c++) = 0;                     W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                     W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                     W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                     W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                     W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                     W(r, c++) = 0;                     W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;
		r =  4; c = 0;
		W(r, c++) = 0;                     W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                     W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                     W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                     W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                     W(r, c++) = 0;                    W(r, c++) = 0;                     W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                     W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                     W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                     W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                     W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                     W(r, c++) = 0;                     W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;
		r =  5; c = 0;
		W(r, c++) = 0;                     W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                     W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                     W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                     W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                     W(r, c++) = 0;                    W(r, c++) = 0;                     W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                     W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                     W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                     W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                     W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                     W(r, c++) = 0;                     W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;
		r =  6; c = 0;
		W(r, c++) = 0.28379858903477262;   W(r, c++) = 0.31021723599658957; W(r, c++) =-0.022990223447282909; W(r, c++) = 0.36760277549278086;  W(r, c++) = 0.0079406425205739151; W(r, c++) = 0.096286861583106287; W(r, c++) = 0.42338101594628064;  W(r, c++) = 0.44976487323212055;  W(r, c++) =-0.2569643779381437;  W(r, c++) = 0.4100160146990397;   W(r, c++) = 0.46103128023961115; W(r, c++) =-0.14970603260346765;   W(r, c++) = 0.17264056357305257; W(r, c++) = 0.069112739524280209; W(r, c++) =-0.25986959217364597; W(r, c++) =-0.49847577814327976; W(r, c++) = 0.16219588897381743;  W(r, c++) =-0.03310776464747639; W(r, c++) =-0.18382286277865761;  W(r, c++) =-0.39981931093629092;  W(r, c++) = 0.37186383571058612;  W(r, c++) = 0.15536186467472957;  W(r, c++) = 0.21849942277153955; W(r, c++) =-0.4517436377117055;   W(r, c++) =-0.15634840634223218;  W(r, c++) =-0.43416532272269898; W(r, c++) =-0.13166854366557407;  W(r, c++) =-0.38108971344614423; W(r, c++) = 0.4829892105452821;    W(r, c++) = 0.10977061041678038; W(r, c++) = 0.21813165177682936; W(r, c++) =-0.35118050971109044;   W(r, c++) = 0.4057807233528663;   W(r, c++) =-0.49975930347483305;   W(r, c++) =-0.37267918706721287;  W(r, c++) =-0.088859803712518615; W(r, c++) =-0.11658592683511254;   W(r, c++) =-0.37289087505289115; W(r, c++) = 0.25661622129736505;  W(r, c++) =-0.40652378070099177;  W(r, c++) =-0.084358803459086806; W(r, c++) =-0.42967053412364425; W(r, c++) = 0.4382622681625481;  W(r, c++) = 0.46651926046699377;  W(r, c++) = 0.39767531415020563; W(r, c++) =-0.42678885063513911;  W(r, c++) =-0.091373778816851881; W(r, c++) = 0.29565715568213224;  W(r, c++) =-0.29636009562963;    W(r, c++) = 0.17817874623596364; W(r, c++) =-0.10376501497190777; W(r, c++) =-0.25095295242444488;  W(r, c++) = 0.27855025905404773; W(r, c++) =-0.027334423792768459; W(r, c++) =-0.02847113169009946;  W(r, c++) = 0.49968512557691136; W(r, c++) = 0.39720097696387546;  W(r, c++) =-0.27984047833395415;  W(r, c++) = 0.11077987624352548;  W(r, c++) = 0.42975985060942634;   W(r, c++) = 0.28667934557605212; W(r, c++) =-0.17485653418675168; W(r, c++) = -0.24536082534428932; W(r, c++) =-0.38187636371243189;  W(r, c++) =-0.31961060874366615;   W(r, c++) =-0.058216366812322506; W(r, c++) = 0.15962079172163635;  W(r, c++) =-0.27844201967217347;  W(r, c++) = 0.085430947205539898; W(r, c++) =-0.2865420636883686;   W(r, c++) =-0.044397098506247568;  W(r, c++) = 0.20341885232229995; W(r, c++) =-0.23989341151586391;  W(r, c++) = 0.15387687330445554;  W(r, c++) = 0.24730900979511949;  W(r, c++) =-0.49688988551084495;  W(r, c++) =-0.33115599496057829; W(r, c++) = 0.30589465601754151; W(r, c++) =-0.23016024527457407;   W(r, c++) = 0.22138771504175336;   W(r, c++) = 0.029272001357831146; W(r, c++) =-0.14664436755663895; W(r, c++) = 0.28278538140399967; W(r, c++) = 0.27861773414610991;  W(r, c++) = 0.29666097122000801;  W(r, c++) =-0.31001172434111918; W(r, c++) =-0.08836360546450811;  W(r, c++) =-0.25080555996627524; W(r, c++) = 0.45800422272294317; W(r, c++) = -0.48903050450588142; W(r, c++) = 0.21048756151161918;  W(r, c++) =-0.45687983695766149; W(r, c++) =-0.19390214598557337;  W(r, c++) = 0.13122137179422799;  W(r, c++) = 0.4355152879393015;   W(r, c++) = 0.14839994006617885;  W(r, c++) = 0.31296209078181569;  W(r, c++) = 0.2337534213446073;   W(r, c++) = 0.33519255315407104; W(r, c++) =-0.30950656571026786;
		r =  7; c = 0;
		W(r, c++) =-0.19668727392107249;   W(r, c++) = 0.4021659504395827;  W(r, c++) = 0.36530992777164006;  W(r, c++) =-0.25608912311286797;  W(r, c++) = 0.43283382422690675;   W(r, c++) =-0.11509885402733949;  W(r, c++) = 0.34246022314018243;  W(r, c++) = 0.079695010745605921; W(r, c++) = 0.23148922079084777; W(r, c++) = 0.034197968260723965; W(r, c++) =-0.31502805860256161; W(r, c++) =-0.31968209847031209;   W(r, c++) = 0.46654890304318319; W(r, c++) = 0.00860013006263316;  W(r, c++) = 0.4531293398277989;  W(r, c++) =-0.30769045875532414; W(r, c++) =-0.45322031404320168;  W(r, c++) = 0.30904585736036239; W(r, c++) =-0.28647533793530383;  W(r, c++) = 0.35393810959733818;  W(r, c++) =-0.2215901847836394;   W(r, c++) = 0.21235765251624172;  W(r, c++) =-0.16174402997332132; W(r, c++) =-0.3204131509584443;   W(r, c++) =-0.020913480848013866; W(r, c++) =-0.4153304308798888;  W(r, c++) = 0.48845905809928947;  W(r, c++) =-0.10204639839768653; W(r, c++) =-0.3515979829139701;    W(r, c++) =-0.28122690312784421; W(r, c++) = 0.30705537997507582; W(r, c++) = 0.15608366177033695;   W(r, c++) =-0.29389516793441667;  W(r, c++) =-0.31803107781378886;   W(r, c++) =-0.21291166000477474;  W(r, c++) = 0.11177086432485994;  W(r, c++) = 0.27641989869967831;   W(r, c++) = 0.41178331812952218; W(r, c++) =-0.044529763187812155; W(r, c++) = 0.31939421508227317;  W(r, c++) =-0.40078901190190425;  W(r, c++) =-0.14074668517876304; W(r, c++) =-0.37681187877076255; W(r, c++) =-0.1377601300551507;   W(r, c++) = 0.44567839149561517; W(r, c++) =-0.079768297825853096; W(r, c++) =-0.082774520203794888; W(r, c++) =-0.053835616050152357; W(r, c++) =-0.49815683938433403; W(r, c++) = 0.26008983672349217; W(r, c++) =-0.39796827177292887; W(r, c++) = 0.41997808785736968;  W(r, c++) = 0.28817742525499013; W(r, c++) =-0.084892599150464265; W(r, c++) = 0.38854504371347653;  W(r, c++) = 0.37314723909179293; W(r, c++) =-0.064729726701831136; W(r, c++) =-0.3038053330833313;   W(r, c++) = 0.11250674789122972;  W(r, c++) = 0.4340763496652581;    W(r, c++) = 0.18050399588172505; W(r, c++) =-0.47117088346190522; W(r, c++) = -0.15605962371844279; W(r, c++) =-0.41852300434452;     W(r, c++) =-0.0099865479763559528; W(r, c++) = 0.10466990219114303;  W(r, c++) = 0.24192155551555827;  W(r, c++) = 0.33179988638735369;  W(r, c++) =-0.47471360257271161;  W(r, c++) = 0.23256059089398828;  W(r, c++) =-0.48736450106926116;   W(r, c++) = 0.32169629869178418; W(r, c++) = 0.17158484579870248;  W(r, c++) =-0.43345490231397116;  W(r, c++) =-0.11733172081684146;  W(r, c++) =-0.36177278591808687;  W(r, c++) = 0.28768139212089539; W(r, c++) = 0.23271895480541605; W(r, c++) =-0.0076868463723303582; W(r, c++) =-0.096221191088938396;  W(r, c++) =-0.15971962074881979;  W(r, c++) = 0.41636156937516;    W(r, c++) = 0.10070299678300032; W(r, c++) = 0.24728195080319604;  W(r, c++) = 0.1050456716470326;   W(r, c++) = 0.28259043717158128; W(r, c++) = 0.11413349806127693;  W(r, c++) = 0.39175426395296797; W(r, c++) =-0.33551400571692119; W(r, c++) =-0.24944194255182356;  W(r, c++) =-0.1718841580897183;   W(r, c++) = 0.42813257009807926; W(r, c++) =-0.44015180943226967;  W(r, c++) = 0.44967867568300202;  W(r, c++) = 0.49854303084311458;  W(r, c++) =-0.043452519097233744; W(r, c++) =-0.42001291286959247;  W(r, c++) =-0.48079919563316215;  W(r, c++) =-0.42257819765637733; W(r, c++) =-0.11234115016391316;
		r =  8; c = 0;
		W(r, c++) =-0.023403045847644133;  W(r, c++) =-0.18985243068066732; W(r, c++) =-0.23950768960804053;  W(r, c++) =-0.17479563725260988;  W(r, c++) =-0.39094215406889626;   W(r, c++) = 0.075651014164888508; W(r, c++) = 0.39817312135787897;  W(r, c++) =-0.04943689336884477;  W(r, c++) =-0.38286570679148196; W(r, c++) = 0.1805891325622565;   W(r, c++) =-0.37610483557556823; W(r, c++) = 0.0036365052098872308; W(r, c++) =-0.44194905617350128; W(r, c++) =-0.18855399899979314;  W(r, c++) =-0.14777443848449251; W(r, c++) =-0.16559830933749836; W(r, c++) =-0.054647810281170106; W(r, c++) = 0.37501633148027114; W(r, c++) = 0.21732414331103722;  W(r, c++) =-0.10330382266909549;  W(r, c++) =-0.48142567245440476;  W(r, c++) = 0.40271015061933069;  W(r, c++) = 0.12053810831655165; W(r, c++) = 0.023050231700098123; W(r, c++) = 0.19959529115061847;  W(r, c++) = 0.249869571783086;   W(r, c++) =-0.23908346455374369;  W(r, c++) =-0.29276802658291706; W(r, c++) =-0.094093116832051071;  W(r, c++) =-0.15977968494896794; W(r, c++) =-0.43364086896221471; W(r, c++) = 0.46859827169270707;   W(r, c++) = 0.035416304328581005; W(r, c++) = 0.0068577868511277007; W(r, c++) = 0.32994068662840603;  W(r, c++) =-0.11331699446676419;  W(r, c++) =-0.0096803224757542883; W(r, c++) = 0.29934121142181402; W(r, c++) = 0.28955872827778317;  W(r, c++) = 0.38877206763198779;  W(r, c++) = 0.27381873247144339;  W(r, c++) =-0.4706224922430135;  W(r, c++) =-0.49281543274772949; W(r, c++) =-0.026629597239888392; W(r, c++) = 0.30439029800010786; W(r, c++) = 0.050777177637437831; W(r, c++) = 0.22818050459967798;  W(r, c++) =-0.10122309487029396;  W(r, c++) = 0.198991711803439;   W(r, c++) =-0.2676372785587548;  W(r, c++) =-0.24739191417528666; W(r, c++) =-0.33644524165918704;  W(r, c++) =-0.20774583188917778; W(r, c++) =-0.023284752004905374; W(r, c++) =-0.48988990600239607;  W(r, c++) = 0.19968580672537095; W(r, c++) =-0.052708104750275153; W(r, c++) = 0.44003464433751038;  W(r, c++) = 0.20492371073993676;  W(r, c++) = 0.080960135568695968;  W(r, c++) = 0.47067579335449572; W(r, c++) =-0.45564747460088301; W(r, c++) =  0.21248039036960897; W(r, c++) =-0.40126956383686468;  W(r, c++) =-0.37191452204839132;   W(r, c++) = 0.036165026086243168; W(r, c++) = 0.015283058794361426; W(r, c++) =-0.25986391257653246;  W(r, c++) =-0.37017714323967271;  W(r, c++) = 0.31617398734159441;  W(r, c++) =-0.2799264076685723;    W(r, c++) = 0.28536875018274888; W(r, c++) =-0.19509758042561615;  W(r, c++) =-0.43759423237347223;  W(r, c++) =-0.090715565600068382; W(r, c++) = 0.36885341750067868;  W(r, c++) = 0.18365922988510708; W(r, c++) =-0.47273281495448821; W(r, c++) =-0.10740675021123941;   W(r, c++) =-0.0039949636820523771; W(r, c++) = 0.47845455135701287;  W(r, c++) = 0.39945353681635698; W(r, c++) = 0.48747102297868927; W(r, c++) =-0.31234541483040107;  W(r, c++) = 0.25475397284803947;  W(r, c++) = 0.29151382402857562; W(r, c++) = 0.30412501663145308;  W(r, c++) =-0.22552734475477326; W(r, c++) = 0.42355928618632122; W(r, c++) = 0.26235240994318165;  W(r, c++) =-0.47569872142305442;  W(r, c++) = 0.34506197239837255; W(r, c++) =-0.37461752524354081;  W(r, c++) =-0.15530164688716425;  W(r, c++) =-0.34480156930780187;  W(r, c++) =-0.26127871265807884;  W(r, c++) =-0.072266954127394645; W(r, c++) = 0.38593851482479236;  W(r, c++) =-0.44599359899232777; W(r, c++) =-0.14239065277349033;
		r =  9; c = 0;
		W(r, c++) = 0.083382039455031198;  W(r, c++) = 0.22983174826012864; W(r, c++) = 0.30502782701302233;  W(r, c++) = 0.37047123210865462;  W(r, c++) = 0.051267246090551222;  W(r, c++) =-0.20967049759724193;  W(r, c++) = 0.42308243982017679;  W(r, c++) = 0.16024537862238897;  W(r, c++) =-0.27953946313217143; W(r, c++) =-0.47330320533779474;  W(r, c++) =-0.2894234901133535;  W(r, c++) =-0.46062129291530757;   W(r, c++) = 0.17620178429937827; W(r, c++) =-0.14284831740973708;  W(r, c++) =-0.21212208514359993; W(r, c++) =-0.26058403981404138; W(r, c++) =-0.24077307655277719;  W(r, c++) = 0.31241493236375906; W(r, c++) =-0.49764243528064606;  W(r, c++) =-0.4186545832317658;   W(r, c++) =-0.45933672632473904;  W(r, c++) = 0.14014119979322415;  W(r, c++) =-0.45879705049379066; W(r, c++) =-0.42913711590565246;  W(r, c++) =-0.073464676455971711; W(r, c++) =-0.43884384345403388; W(r, c++) = 0.27710015450850956;  W(r, c++) =-0.45789857210933799; W(r, c++) = 0.17992948311000223;   W(r, c++) = 0.46256646325468176; W(r, c++) =-0.41535686316692982; W(r, c++) = 0.0049996926056783408; W(r, c++) = 0.09861426366746906;  W(r, c++) =-0.24554060151662066;   W(r, c++) =-0.44447295411033855;  W(r, c++) =-0.45296708418815951;  W(r, c++) = 0.38127661541224134;   W(r, c++) = 0.41688740809100933; W(r, c++) =-0.42466041478143973;  W(r, c++) = 0.27939571069488567;  W(r, c++) = 0.23427934165711584;  W(r, c++) =-0.15212227271566042; W(r, c++) =-0.13086985282997426; W(r, c++) =-0.20736801403502642;  W(r, c++) =-0.18410858133187552; W(r, c++) = 0.24087881987092197;  W(r, c++) =-0.17932899712549605;  W(r, c++) = 0.26764074282127848;  W(r, c++) = 0.1187355180234525;  W(r, c++) = 0.26199501309771167; W(r, c++) =-0.2166034961395113;  W(r, c++) =-0.085169599496267179; W(r, c++) =-0.12819567644422541; W(r, c++) = 0.19469563291644421;  W(r, c++) = 0.026828020653922868; W(r, c++) = 0.2270999543422898;  W(r, c++) = 0.20882775744423798;  W(r, c++) = 0.086530258581020036; W(r, c++) = 0.012118650611431248; W(r, c++) =-0.0097979362699969763; W(r, c++) =-0.10348551304810866; W(r, c++) =-0.13129587411794102; W(r, c++) = -0.4554970986707903;  W(r, c++) = 0.26544137413647528;  W(r, c++) = 0.37109264194217328;   W(r, c++) =-0.23901202326606047;  W(r, c++) = 0.35909581966527071;  W(r, c++) = 0.018153297212112229; W(r, c++) =-0.10441914830175686;  W(r, c++) = 0.25996654022191923;  W(r, c++) = 0.15276342006800492;   W(r, c++) =-0.11590766948628867; W(r, c++) =-0.14364209343796147;  W(r, c++) = 0.47209324437361677;  W(r, c++) =-0.23625909884493362;  W(r, c++) = 0.013934596181302994; W(r, c++) =-0.33168523968910574; W(r, c++) = 0.43242300964503477; W(r, c++) =-0.18923580251379296;   W(r, c++) =-0.47931623255424433;   W(r, c++) = 0.47186655737931849;  W(r, c++) =-0.16934153552192061; W(r, c++) =-0.49898720690354642; W(r, c++) = 0.048877261102780345; W(r, c++) =-0.23424146837444776;  W(r, c++) = 0.34474162761813076; W(r, c++) =-0.27169790938634947;  W(r, c++) = 0.44494501321073388; W(r, c++) = 0.4279862525071727;  W(r, c++) =-0.11337496760776683;  W(r, c++) =-0.026275069110689053; W(r, c++) = 0.44529764373145608; W(r, c++) =-0.36604384399488027;  W(r, c++) = 0.085883355237539205; W(r, c++) = 0.40016238725800035;  W(r, c++) =-0.041329618377515642; W(r, c++) =-0.14767988346312794;  W(r, c++) =-0.30665713515773779;  W(r, c++) =-0.14501970556272697; W(r, c++) =-0.37663437406579653;
		r = 10; c = 0;
		W(r, c++) = 0.40811288519533517;   W(r, c++) = 0.39883828796799348; W(r, c++) = 0.048699303835589292; W(r, c++) =-0.3089329084976094;   W(r, c++) = 0.20656140986688964;   W(r, c++) =-0.3106086714456438;   W(r, c++) = 0.040599924948054422; W(r, c++) = 0.49625783935357271;  W(r, c++) = 0.2945829717105759;  W(r, c++) = 0.13499990991145827;  W(r, c++) = 0.30074659035418094; W(r, c++) =-0.39907875881103333;   W(r, c++) = 0.34542459370161638; W(r, c++) = 0.33766117436897902;  W(r, c++) =-0.14079880274625362; W(r, c++) = 0.13739940112930027; W(r, c++) =-0.34231342787768909;  W(r, c++) =-0.31199870594917195; W(r, c++) = 0.32273141053141574;  W(r, c++) =-0.22528615658073786;  W(r, c++) = 0.18099677011124327;  W(r, c++) =-0.12755073702774394;  W(r, c++) =-0.33613945432442399; W(r, c++) =-0.096830853554906449; W(r, c++) =-0.198096883780644;    W(r, c++) =-0.49214899466874812; W(r, c++) =-0.068778975367955797; W(r, c++) = 0.44796135125631997; W(r, c++) = 0.37765658290109516;   W(r, c++) = 0.39900803803100759; W(r, c++) = 0.36889531400437847; W(r, c++) = 0.4010904768840049;    W(r, c++) = 0.32569661716035381;  W(r, c++) =-0.43437915672726918;   W(r, c++) =-0.46406616656981098;  W(r, c++) =-0.029110790951934751; W(r, c++) = 0.11011974290622339;   W(r, c++) = 0.37253472177346691; W(r, c++) =-0.45535909457558749;  W(r, c++) = 0.19850243273162493;  W(r, c++) =-0.4692991540480938;   W(r, c++) =-0.49003575868703392; W(r, c++) =-0.47534998556384417; W(r, c++) = 0.43712684421546977;  W(r, c++) =-0.25716131004201476; W(r, c++) =-0.35771652615758393;  W(r, c++) =-0.29600972405376597;  W(r, c++) =-0.068283504435887876; W(r, c++) =-0.49222335056413574; W(r, c++) =-0.21991161531161069; W(r, c++) = 0.2552228545587315;  W(r, c++) =-0.21030805049279416;  W(r, c++) = 0.12881090594688616; W(r, c++) =-0.181759823167922;    W(r, c++) =-0.43354317034113693;  W(r, c++) =-0.27331297739833754; W(r, c++) = 0.02416187015229232;  W(r, c++) =-0.45020673494173508;  W(r, c++) =-0.21557600966520168;  W(r, c++) = 0.20411681738236886;   W(r, c++) = 0.42139191345105276; W(r, c++) =-0.29040867187121627; W(r, c++) =  0.43418346011619102; W(r, c++) =-0.085987151531481343; W(r, c++) = 0.43446088844614883;   W(r, c++) =-0.26821212458194471;  W(r, c++) =-0.37820610862452836;  W(r, c++) = 0.17464575415335126;  W(r, c++) = 0.4757565794644123;   W(r, c++) =-0.14653759741411293;  W(r, c++) = 0.16084927975444896;   W(r, c++) =-0.44081969403726301; W(r, c++) = 0.039513305263094378; W(r, c++) =-0.077347106219450124; W(r, c++) = 0.031336678598825052; W(r, c++) = 0.23243484422267668;  W(r, c++) =-0.42151135633008724; W(r, c++) =-0.46368395167332183; W(r, c++) = 0.40054165786674401;   W(r, c++) = 0.239958502320053;     W(r, c++) =-0.29103026452663988;  W(r, c++) = 0.24739491060435859; W(r, c++) =-0.3592412578418645;  W(r, c++) =-0.076120769391155141; W(r, c++) =-0.21503716697070657;  W(r, c++) = 0.25005270921693268; W(r, c++) =-0.4843079569770215;   W(r, c++) = 0.42649671003209022; W(r, c++) = 0.13474893864052184; W(r, c++) = 0.27544672515521318;  W(r, c++) = 0.021692738945334966; W(r, c++) =-0.18519896721356649; W(r, c++) =-0.019107135345689696; W(r, c++) =-0.41720093726568358;  W(r, c++) = 0.052726485973738968; W(r, c++) =-0.34061029024771777;  W(r, c++) =-0.04841936129475094;  W(r, c++) =-0.086163709719531523; W(r, c++) = 0.4018413321683949;  W(r, c++) =-0.14921563102798813;
		r = 11; c = 0;
		W(r, c++) = 0.0046868558173902564; W(r, c++) = 0.18398393191544127; W(r, c++) =-0.48595829983598099;  W(r, c++) = 0.067510740620671861; W(r, c++) = 0.047440911328423763;  W(r, c++) =-0.31327047174444483;  W(r, c++) =-0.10870394976537506;  W(r, c++) = 0.41694121794745609;  W(r, c++) =-0.16746385078034448; W(r, c++) = 0.10633841775421893;  W(r, c++) = 0.43696915864458075; W(r, c++) = 0.48823514872250107;   W(r, c++) =-0.15768745892141595; W(r, c++) =-0.24906733517786289;  W(r, c++) = 0.4469058356578911;  W(r, c++) =-0.1213519296769055;  W(r, c++) = 0.027573130167614646; W(r, c++) = 0.49942035945533036; W(r, c++) = 0.028345976859792787; W(r, c++) =-0.047021815182085647; W(r, c++) = 0.058355736097046917; W(r, c++) = 0.037928783731820515; W(r, c++) = 0.4819140701253054;  W(r, c++) =-0.17147928998451306;  W(r, c++) = 0.2347509912186152;   W(r, c++) =-0.10619204821829048; W(r, c++) =-0.14147961799046099;  W(r, c++) =-0.2841056315346428;  W(r, c++) =-0.0045940750888112114; W(r, c++) = 0.3181183809177941;  W(r, c++) =-0.46058417062197116; W(r, c++) = 0.0024285989524275298; W(r, c++) =-0.017786436934083827; W(r, c++) = 0.35988342212146163;   W(r, c++) =-0.082133955203705422; W(r, c++) =-0.34863224610516369;  W(r, c++) =-0.032811584961929652;  W(r, c++) = 0.18100644635705698; W(r, c++) = 0.43428958237156767;  W(r, c++) =-0.079888883925179177; W(r, c++) =-0.053281400866163453; W(r, c++) = 0.47432351284096785; W(r, c++) = 0.10484823758053108; W(r, c++) = 0.45814789498749753;  W(r, c++) = 0.25485841321903779; W(r, c++) =-0.077811253830581129; W(r, c++) =-0.20668834483369486;  W(r, c++) =-0.25204233110299484;  W(r, c++) =-0.20143987898187915; W(r, c++) = 0.48401513711824551; W(r, c++) = 0.40877432522200707; W(r, c++) = 0.019834102201614634; W(r, c++) =-0.34293003288434282; W(r, c++) = 0.15205448089854834;  W(r, c++) = 0.36710977614948825;  W(r, c++) = 0.25161393413581201; W(r, c++) =-0.37077696465800641;  W(r, c++) =-0.1116524038219508;   W(r, c++) = 0.37745745392852792;  W(r, c++) =-0.28458040701453197;   W(r, c++) =-0.04629582768046675; W(r, c++) = 0.02451460321059229; W(r, c++) = -0.42766226821237457; W(r, c++) = 0.41923415819903109;  W(r, c++) =-0.18040300164618234;   W(r, c++) =-0.38126976329928891;  W(r, c++) = 0.14519696140650518;  W(r, c++) =-0.26639682521524338;  W(r, c++) = 0.010474517876123191; W(r, c++) = 0.091028050575708619; W(r, c++) =-0.0053010597136868287; W(r, c++) =-0.46171213451655718; W(r, c++) = 0.2323138239267305;   W(r, c++) = 0.39242893399285916;  W(r, c++) = 0.2356369121419466;   W(r, c++) =-0.3518321135666414;   W(r, c++) = 0.42764942992228894; W(r, c++) =-0.41038068116929255; W(r, c++) = 0.050448450959604374;  W(r, c++) =-0.46572645564436926;   W(r, c++) = 0.066038235885829355; W(r, c++) =-0.49090787332555136; W(r, c++) =-0.45639861790918651; W(r, c++) = 0.44978804759788804;  W(r, c++) =-0.071296358268475413; W(r, c++) =-0.34466698181145289; W(r, c++) = 0.029094897073142167; W(r, c++) =-0.42207547595247202; W(r, c++) = 0.44039082729706724; W(r, c++) = 0.12564249093142477;  W(r, c++) =-0.45841374932615436;  W(r, c++) = 0.40526738856189426; W(r, c++) = 0.14189338472689483;  W(r, c++) = 0.059796587932298695; W(r, c++) =-0.46139885758948246;  W(r, c++) =-0.1663340932677036;   W(r, c++) = 0.33350982053626654;  W(r, c++) =-0.4379606939938519;   W(r, c++) = 0.25646770191064616; W(r, c++) =-0.32291312214908513;
	}

	// Q = eye(nx, nx);
	matrix_type Q(ublas::identity_matrix<real_type>(nx,nx));

	// R = eye(nu, nu);
	matrix_type R(ublas::identity_matrix<real_type>(nu,nu));

	// Qf = Q
	matrix_type Qf(Q);

	vector_type xmin(nx, -4);

	vector_type xmax(nx, 4);

	vector_type umin(nu, -0.5);

	vector_type umax(nu, 0.5);

	vector_type x0(nx, 0);

	size_type niters = 5;
	size_type T = 10;
	real_type kappa = 0.01;

	matrix_type X(nx, T, 0);
	matrix_type U(nu, T, 0);
	vector_type x(x0);

	matrix_type Xhist(nx, nsteps, 0); // state
	matrix_type Uhist(nu, nsteps, 0); // input
	vector_type Jhist(nsteps, 0); // stage cost
	vector_type thist(nsteps, 0); // fmpc runtime

	size_type n = nsteps;
	//n = 10;//XXX
	for (size_type k = 0; k < n; ++k)
	{
		std::cout << "--- MPC STEP #" << (k+1) << std::endl;

		dcs::control::fmpc_step(A,
								B,
								Q,
								R,
								Qf,
								xmin,
								xmax,
								umin,
								umax,
								T,
								kappa,
								niters,
								X,
								U,
								x);

		vector_type u(ublas::column(U, 0));
		//std::cerr << "u=" << u << std::endl;

		// record state, input, stage cost, and fmpc run time
		ublas::column(Xhist, k) = x;
		ublas::column(Uhist, k) = u;
		vector_type xtQ(ublas::prod(x, Q));
		vector_type utR(ublas::prod(u, R));
		Jhist(k) = ublas::inner_prod(xtQ, x) + ublas::inner_prod(utR, u);
		//thist(k) = telapsed;

		// state update
		vector_type Ax;
		Ax = ublas::prod(A, x);
		vector_type Bu;
		Bu = ublas::prod(B, u);
		x = Ax+Bu+ublas::column(W, k);
		//std::cerr << "x=" << x << std::endl;

		// shift previous state and input trajectories
		// for warm start in next step
		X = ublasx::cat_rows(ublas::subrange(X, 0, nx, 1, T), ublas::zero_matrix<real_type>(nx, 1));
		//std::cerr << "New X=" << X << std::endl;
		U = ublasx::cat_rows(ublas::subrange(U, 0, nu, 1, T), ublas::zero_matrix<real_type>(nu, 1));
		//std::cerr << "New U=" << U << std::endl;
	}

	std::cout << std::endl << "The average cost is: " << ublas::sum(Jhist)/nsteps << std::endl;
}


DCS_TEST_DEF( oo )
{
	DCS_TEST_CASE("Object-Oriented");

	namespace ublas = ::boost::numeric::ublas;
	namespace ublasx = ::boost::numeric::ublasx;

    /* problem setup */

	typedef double real_type;
	typedef int size_type;
	typedef ublas::matrix<real_type, ublas::column_major> matrix_type;
	typedef ublas::vector<real_type> vector_type;

	const size_type nx = 12;
	const size_type nu = 3;
	const size_type nsteps = 100;

	matrix_type A(nx,nx);
	{
		size_type r;
		size_type c;

		r =  0, c = 0;
		A(r,c++) = 7.6272e-01; A(r,c++) = 1.1488e-01; A(r,c++) = 2.4765e-03; A(r,c++) = 2.0938e-05; A(r,c++) = 9.4223e-08; A(r,c++) = 2.6306e-10; A(r,c++) = 4.5961e-01; A(r,c++) = 1.9813e-02; A(r,c++) = 2.5126e-04; A(r,c++) = 1.5076e-06; A(r,c++) = 5.2612e-09; A(r,c++) = 1.1999e-11;
		r =  1, c = 0;
		A(r,c++) = 1.1488e-01; A(r,c++) = 7.6520e-01; A(r,c++) = 1.1490e-01; A(r,c++) = 2.4766e-03; A(r,c++) = 2.0938e-05; A(r,c++) = 9.4223e-08; A(r,c++) = 1.9813e-02; A(r,c++) = 4.5987e-01; A(r,c++) = 1.9815e-02; A(r,c++) = 2.5127e-04; A(r,c++) = 1.5076e-06; A(r,c++) = 5.2612e-09;
		r =  2, c = 0;
		A(r,c++) = 2.4765e-03; A(r,c++) = 1.1490e-01; A(r,c++) = 7.6520e-01; A(r,c++) = 1.1490e-01; A(r,c++) = 2.4766e-03; A(r,c++) = 2.0938e-05; A(r,c++) = 2.5126e-04; A(r,c++) = 1.9815e-02; A(r,c++) = 4.5987e-01; A(r,c++) = 1.9815e-02; A(r,c++) = 2.5127e-04; A(r,c++) = 1.5076e-06;
		r =  3, c = 0;
		A(r,c++) = 2.0938e-05; A(r,c++) = 2.4766e-03; A(r,c++) = 1.1490e-01; A(r,c++) = 7.6520e-01; A(r,c++) = 1.1490e-01; A(r,c++) = 2.4765e-03; A(r,c++) = 1.5076e-06; A(r,c++) = 2.5127e-04; A(r,c++) = 1.9815e-02; A(r,c++) = 4.5987e-01; A(r,c++) = 1.9815e-02; A(r,c++) = 2.5126e-04;
		r =  4, c = 0;
		A(r,c++) = 9.4223e-08; A(r,c++) = 2.0938e-05; A(r,c++) = 2.4766e-03; A(r,c++) = 1.1490e-01; A(r,c++) = 7.6520e-01; A(r,c++) = 1.1488e-01; A(r,c++) = 5.2612e-09; A(r,c++) = 1.5076e-06; A(r,c++) = 2.5127e-04; A(r,c++) = 1.9815e-02; A(r,c++) = 4.5987e-01; A(r,c++) = 1.9813e-02;
		r =  5, c = 0;
		A(r,c++) = 2.6306e-10; A(r,c++) = 9.4223e-08; A(r,c++) = 2.0938e-05; A(r,c++) = 2.4765e-03; A(r,c++) = 1.1488e-01; A(r,c++) = 7.6272e-01; A(r,c++) = 1.1999e-11; A(r,c++) = 5.2612e-09; A(r,c++) = 1.5076e-06; A(r,c++) = 2.5126e-04; A(r,c++) = 1.9813e-02; A(r,c++) = 4.5961e-01;
		r =  6, c = 0;
		A(r,c++) =-8.9941e-01; A(r,c++) = 4.2024e-01; A(r,c++) = 1.9312e-02; A(r,c++) = 2.4825e-04; A(r,c++) = 1.4971e-06; A(r,c++) = 5.2372e-09; A(r,c++) = 7.6272e-01; A(r,c++) = 1.1488e-01; A(r,c++) = 2.4765e-03; A(r,c++) = 2.0938e-05; A(r,c++) = 9.4223e-08; A(r,c++) = 2.6306e-10;
		r =  7, c = 0;
		A(r,c++) = 4.2024e-01; A(r,c++) =-8.8010e-01; A(r,c++) = 4.2049e-01; A(r,c++) = 1.9314e-02; A(r,c++) = 2.4826e-04; A(r,c++) = 1.4971e-06; A(r,c++) = 1.1488e-01; A(r,c++) = 7.6520e-01; A(r,c++) = 1.1490e-01; A(r,c++) = 2.4766e-03; A(r,c++) = 2.0938e-05; A(r,c++) = 9.4223e-08;
		r =  8, c = 0;
		A(r,c++) = 1.9312e-02; A(r,c++) = 4.2049e-01; A(r,c++) =-8.8010e-01; A(r,c++) = 4.2049e-01; A(r,c++) = 1.9314e-02; A(r,c++) = 2.4825e-04; A(r,c++) = 2.4765e-03; A(r,c++) = 1.1490e-01; A(r,c++) = 7.6520e-01; A(r,c++) = 1.1490e-01; A(r,c++) = 2.4766e-03; A(r,c++) = 2.0938e-05;
		r =  9, c = 0;
		A(r,c++) = 2.4825e-04; A(r,c++) = 1.9314e-02; A(r,c++) = 4.2049e-01; A(r,c++) =-8.8010e-01; A(r,c++) = 4.2049e-01; A(r,c++) = 1.9312e-02; A(r,c++) = 2.0938e-05; A(r,c++) = 2.4766e-03; A(r,c++) = 1.1490e-01; A(r,c++) = 7.6520e-01; A(r,c++) = 1.1490e-01; A(r,c++) = 2.4765e-03;
		r = 10, c = 0;
		A(r,c++) = 1.4971e-06; A(r,c++) = 2.4826e-04; A(r,c++) = 1.9314e-02; A(r,c++) = 4.2049e-01; A(r,c++) =-8.8010e-01; A(r,c++) = 4.2024e-01; A(r,c++) = 9.4223e-08; A(r,c++) = 2.0938e-05; A(r,c++) = 2.4766e-03; A(r,c++) = 1.1490e-01; A(r,c++) = 7.6520e-01; A(r,c++) = 1.1488e-01;
		r = 11, c = 0;
		A(r,c++) = 5.2372e-09; A(r,c++) = 1.4971e-06; A(r,c++) = 2.4825e-04; A(r,c++) = 1.9312e-02; A(r,c++) = 4.2024e-01; A(r,c++) =-8.9941e-01; A(r,c++) = 2.6306e-10; A(r,c++) = 9.4223e-08; A(r,c++) = 2.0938e-05; A(r,c++) = 2.4765e-03; A(r,c++) = 1.1488e-01; A(r,c++) = 7.6272e-01;
	}


//
//A(r,c++) =-0.3348335; A(r,c++) =-0.0284175; A(r,c++) =-0.0632027; A(r,c++) = 0.1016925; A(r,c++) =-0.2566873; A(r,c++) = 0.1077508; A(r,c++) = 0.6492243; A(r,c++) =-0.1333071; A(r,c++) = 0.2439793; A(r,c++) = 0.7718376; A(r,c++) =-0.4974038; A(r,c++) = 0.1209940
//A(r,c++) = 0.2088102; A(r,c++) =-0.0310917; A(r,c++) = 0.2379796; A(r,c++) =-0.1036839; A(r,c++) = 0.6371286; A(r,c++) =-0.0284110; A(r,c++) =-0.0860856; A(r,c++) =-0.1494710; A(r,c++) = 0.0580248; A(r,c++) = 0.0102606; A(r,c++) =-0.0158337; A(r,c++) =-0.2036900
//A(r,c++) =-0.1145483; A(r,c++) = 0.1292763; A(r,c++) = 0.2615429; A(r,c++) = 0.2144771; A(r,c++) =-0.0119147; A(r,c++) = 0.3290591; A(r,c++) = 0.4078635; A(r,c++) =-0.0277792; A(r,c++) = 0.0361168; A(r,c++) =-0.4566963; A(r,c++) =-0.0755472; A(r,c++) = 0.0928260
//A(r,c++) = 0.1379477; A(r,c++) =-0.3913603; A(r,c++) =-0.2806261; A(r,c++) =-0.0815659; A(r,c++) = 0.0935242; A(r,c++) = 0.2101101; A(r,c++) = 0.0044150; A(r,c++) =-0.2115512; A(r,c++) = 0.0886437; A(r,c++) =-0.1172099; A(r,c++) =-0.4759982; A(r,c++) = 0.3133121
//A(r,c++) = 0.1578509; A(r,c++) = 0.1819193; A(r,c++) = 0.2491764; A(r,c++) =-0.2829379; A(r,c++) =-0.0221198; A(r,c++) =-0.1623121; A(r,c++) = 0.1237108; A(r,c++) = 0.0717485; A(r,c++) =-0.0290915; A(r,c++) = 0.4656527; A(r,c++) = 0.0666658; A(r,c++) =-0.1369200
//A(r,c++) = 0.1478784; A(r,c++) =-0.0200370; A(r,c++) =-0.5136189; A(r,c++) =-0.2787899; A(r,c++) = 0.0403804; A(r,c++) =-0.3519817; A(r,c++) =-0.1089885; A(r,c++) = 0.0481487; A(r,c++) = 0.3996247; A(r,c++) = 0.3101364; A(r,c++) = 0.6673644; A(r,c++) = 0.0961400
//A(r,c++) =-0.1646019; A(r,c++) = 0.2070053; A(r,c++) = 0.0291860; A(r,c++) = 0.0599168; A(r,c++) = 0.6533651; A(r,c++) =-0.0452402; A(r,c++) = 0.2095925; A(r,c++) = 0.1405550; A(r,c++) =-0.2760067; A(r,c++) = 0.3321128; A(r,c++) = 0.3576991; A(r,c++) = 0.3434609
//A(r,c++) =-0.0116156; A(r,c++) =-0.2095673; A(r,c++) = 0.5156251; A(r,c++) = 0.4244239; A(r,c++) =-0.0091870; A(r,c++) =-0.3966204; A(r,c++) = 0.0797500; A(r,c++) = 0.2325908; A(r,c++) = 0.1889487; A(r,c++) = 0.0156177; A(r,c++) =-0.1792414; A(r,c++) = 0.0570808
//A(r,c++) = 0.0502684; A(r,c++) =-0.0511950; A(r,c++) =-0.5103361; A(r,c++) = 0.3587348; A(r,c++) =-0.2962217; A(r,c++) = 0.4923480; A(r,c++) = 0.0308246; A(r,c++) =-0.1435624; A(r,c++) = 0.1306456; A(r,c++) = 0.0024575; A(r,c++) = 0.5743270; A(r,c++) =-0.1998096
//A(r,c++) =-0.0180091; A(r,c++) =-0.2121577; A(r,c++) = 0.3266548; A(r,c++) = 0.3826798; A(r,c++) =-0.0488264; A(r,c++) = 0.1047580; A(r,c++) =-0.1450352; A(r,c++) = 0.2917253; A(r,c++) =-0.1385374; A(r,c++) =-0.2545077; A(r,c++) =-0.0608299; A(r,c++) = 0.1744774
//A(r,c++) =-0.0954432; A(r,c++) = 0.1454592; A(r,c++) = 0.3294977; A(r,c++) = 0.0186939; A(r,c++) =-0.4423610; A(r,c++) = 0.0831251; A(r,c++) =-0.5767238; A(r,c++) =-0.0125269; A(r,c++) =-0.1562947; A(r,c++) =-0.2764103; A(r,c++) =-0.2167474; A(r,c++) = 0.0678182
//A(r,c++) = 0.1782933; A(r,c++) = 0.0233594; A(r,c++) = 0.1728577; A(r,c++) =-0.0060443; A(r,c++) = 0.2036175; A(r,c++) =-0.4824848; A(r,c++) = 0.2222103; A(r,c++) = 0.0148148; A(r,c++) =-0.1092411; A(r,c++) = 0.5575757; A(r,c++) =-0.4301168; A(r,c++) =-0.1856023


	matrix_type B(nx,nu);
	{
		size_type r;
		size_type c;

		r =  0; c = 0;
		B(r,c++) = 1.1738e-01; B(r,c++) = 2.1127e-05; B(r,c++) = 9.4750e-08;
		r =  1; c = 0;
		B(r,c++) =-1.1740e-01; B(r,c++) = 2.5187e-03; B(r,c++) = 2.1127e-05;
		r =  2; c = 0;
		B(r,c++) =-2.4977e-03; B(r,c++) = 1.1990e-01; B(r,c++) = 2.5187e-03;
		r =  3; c = 0;
		B(r,c++) =-2.1033e-05; B(r,c++) = 5.0038e-13; B(r,c++) = 1.1990e-01;
		r =  4; c = 0;
		B(r,c++) =-9.4487e-08; B(r,c++) =-1.1990e-01; B(r,c++) = 9.4751e-08;
		r =  5; c = 0;
		B(r,c++) =-2.6356e-10; B(r,c++) =-2.5186e-03; B(r,c++) =-1.1988e-01;
		r =  6; c = 0;
		B(r,c++) = 4.3980e-01; B(r,c++) = 2.5125e-04; B(r,c++) = 1.5076e-06;
		r =  7; c = 0;
		B(r,c++) =-4.4005e-01; B(r,c++) = 1.9813e-02; B(r,c++) = 2.5126e-04;
		r =  8; c = 0;
		B(r,c++) =-1.9563e-02; B(r,c++) = 4.5961e-01; B(r,c++) = 1.9813e-02;
		r =  9; c = 0;
		B(r,c++) =-2.4976e-04; B(r,c++) = 1.1999e-11; B(r,c++) = 4.5961e-01;
		r = 10; c = 0;
		B(r,c++) =-1.5023e-06; B(r,c++) =-4.5961e-01; B(r,c++) = 1.5076e-06;
		r = 11; c = 0;
		B(r,c++) =-5.2492e-09; B(r,c++) =-1.9812e-02; B(r,c++) =-4.5936e-01;
	}


	// process noise trajectory
	matrix_type W(nx, nsteps);
	{
		size_type r;
		size_type c;

		r = 0; c = 0;
		W(r, c++) = 0;                     W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                     W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                     W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                     W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                     W(r, c++) = 0;                    W(r, c++) = 0;                     W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                     W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                     W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                     W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                     W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                     W(r, c++) = 0;                     W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;
		r =  1; c = 0;
		W(r, c++) = 0;                     W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                     W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                     W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                     W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                     W(r, c++) = 0;                    W(r, c++) = 0;                     W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                     W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                     W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                     W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                     W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                     W(r, c++) = 0;                     W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;
		r =  2; c = 0;
		W(r, c++) = 0;                     W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                     W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                     W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                     W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                     W(r, c++) = 0;                    W(r, c++) = 0;                     W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                     W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                     W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                     W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                     W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                     W(r, c++) = 0;                     W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;
		r =  3; c = 0;
		W(r, c++) = 0;                     W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                     W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                     W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                     W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                     W(r, c++) = 0;                    W(r, c++) = 0;                     W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                     W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                     W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                     W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                     W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                     W(r, c++) = 0;                     W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;
		r =  4; c = 0;
		W(r, c++) = 0;                     W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                     W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                     W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                     W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                     W(r, c++) = 0;                    W(r, c++) = 0;                     W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                     W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                     W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                     W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                     W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                     W(r, c++) = 0;                     W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;
		r =  5; c = 0;
		W(r, c++) = 0;                     W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                     W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                     W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                     W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                     W(r, c++) = 0;                    W(r, c++) = 0;                     W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                     W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                     W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                     W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                     W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                     W(r, c++) = 0;                     W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                    W(r, c++) = 0;                   W(r, c++) = 0;
		r =  6; c = 0;
		W(r, c++) = 0.28379858903477262;   W(r, c++) = 0.31021723599658957; W(r, c++) =-0.022990223447282909; W(r, c++) = 0.36760277549278086;  W(r, c++) = 0.0079406425205739151; W(r, c++) = 0.096286861583106287; W(r, c++) = 0.42338101594628064;  W(r, c++) = 0.44976487323212055;  W(r, c++) =-0.2569643779381437;  W(r, c++) = 0.4100160146990397;   W(r, c++) = 0.46103128023961115; W(r, c++) =-0.14970603260346765;   W(r, c++) = 0.17264056357305257; W(r, c++) = 0.069112739524280209; W(r, c++) =-0.25986959217364597; W(r, c++) =-0.49847577814327976; W(r, c++) = 0.16219588897381743;  W(r, c++) =-0.03310776464747639; W(r, c++) =-0.18382286277865761;  W(r, c++) =-0.39981931093629092;  W(r, c++) = 0.37186383571058612;  W(r, c++) = 0.15536186467472957;  W(r, c++) = 0.21849942277153955; W(r, c++) =-0.4517436377117055;   W(r, c++) =-0.15634840634223218;  W(r, c++) =-0.43416532272269898; W(r, c++) =-0.13166854366557407;  W(r, c++) =-0.38108971344614423; W(r, c++) = 0.4829892105452821;    W(r, c++) = 0.10977061041678038; W(r, c++) = 0.21813165177682936; W(r, c++) =-0.35118050971109044;   W(r, c++) = 0.4057807233528663;   W(r, c++) =-0.49975930347483305;   W(r, c++) =-0.37267918706721287;  W(r, c++) =-0.088859803712518615; W(r, c++) =-0.11658592683511254;   W(r, c++) =-0.37289087505289115; W(r, c++) = 0.25661622129736505;  W(r, c++) =-0.40652378070099177;  W(r, c++) =-0.084358803459086806; W(r, c++) =-0.42967053412364425; W(r, c++) = 0.4382622681625481;  W(r, c++) = 0.46651926046699377;  W(r, c++) = 0.39767531415020563; W(r, c++) =-0.42678885063513911;  W(r, c++) =-0.091373778816851881; W(r, c++) = 0.29565715568213224;  W(r, c++) =-0.29636009562963;    W(r, c++) = 0.17817874623596364; W(r, c++) =-0.10376501497190777; W(r, c++) =-0.25095295242444488;  W(r, c++) = 0.27855025905404773; W(r, c++) =-0.027334423792768459; W(r, c++) =-0.02847113169009946;  W(r, c++) = 0.49968512557691136; W(r, c++) = 0.39720097696387546;  W(r, c++) =-0.27984047833395415;  W(r, c++) = 0.11077987624352548;  W(r, c++) = 0.42975985060942634;   W(r, c++) = 0.28667934557605212; W(r, c++) =-0.17485653418675168; W(r, c++) = -0.24536082534428932; W(r, c++) =-0.38187636371243189;  W(r, c++) =-0.31961060874366615;   W(r, c++) =-0.058216366812322506; W(r, c++) = 0.15962079172163635;  W(r, c++) =-0.27844201967217347;  W(r, c++) = 0.085430947205539898; W(r, c++) =-0.2865420636883686;   W(r, c++) =-0.044397098506247568;  W(r, c++) = 0.20341885232229995; W(r, c++) =-0.23989341151586391;  W(r, c++) = 0.15387687330445554;  W(r, c++) = 0.24730900979511949;  W(r, c++) =-0.49688988551084495;  W(r, c++) =-0.33115599496057829; W(r, c++) = 0.30589465601754151; W(r, c++) =-0.23016024527457407;   W(r, c++) = 0.22138771504175336;   W(r, c++) = 0.029272001357831146; W(r, c++) =-0.14664436755663895; W(r, c++) = 0.28278538140399967; W(r, c++) = 0.27861773414610991;  W(r, c++) = 0.29666097122000801;  W(r, c++) =-0.31001172434111918; W(r, c++) =-0.08836360546450811;  W(r, c++) =-0.25080555996627524; W(r, c++) = 0.45800422272294317; W(r, c++) = -0.48903050450588142; W(r, c++) = 0.21048756151161918;  W(r, c++) =-0.45687983695766149; W(r, c++) =-0.19390214598557337;  W(r, c++) = 0.13122137179422799;  W(r, c++) = 0.4355152879393015;   W(r, c++) = 0.14839994006617885;  W(r, c++) = 0.31296209078181569;  W(r, c++) = 0.2337534213446073;   W(r, c++) = 0.33519255315407104; W(r, c++) =-0.30950656571026786;
		r =  7; c = 0;
		W(r, c++) =-0.19668727392107249;   W(r, c++) = 0.4021659504395827;  W(r, c++) = 0.36530992777164006;  W(r, c++) =-0.25608912311286797;  W(r, c++) = 0.43283382422690675;   W(r, c++) =-0.11509885402733949;  W(r, c++) = 0.34246022314018243;  W(r, c++) = 0.079695010745605921; W(r, c++) = 0.23148922079084777; W(r, c++) = 0.034197968260723965; W(r, c++) =-0.31502805860256161; W(r, c++) =-0.31968209847031209;   W(r, c++) = 0.46654890304318319; W(r, c++) = 0.00860013006263316;  W(r, c++) = 0.4531293398277989;  W(r, c++) =-0.30769045875532414; W(r, c++) =-0.45322031404320168;  W(r, c++) = 0.30904585736036239; W(r, c++) =-0.28647533793530383;  W(r, c++) = 0.35393810959733818;  W(r, c++) =-0.2215901847836394;   W(r, c++) = 0.21235765251624172;  W(r, c++) =-0.16174402997332132; W(r, c++) =-0.3204131509584443;   W(r, c++) =-0.020913480848013866; W(r, c++) =-0.4153304308798888;  W(r, c++) = 0.48845905809928947;  W(r, c++) =-0.10204639839768653; W(r, c++) =-0.3515979829139701;    W(r, c++) =-0.28122690312784421; W(r, c++) = 0.30705537997507582; W(r, c++) = 0.15608366177033695;   W(r, c++) =-0.29389516793441667;  W(r, c++) =-0.31803107781378886;   W(r, c++) =-0.21291166000477474;  W(r, c++) = 0.11177086432485994;  W(r, c++) = 0.27641989869967831;   W(r, c++) = 0.41178331812952218; W(r, c++) =-0.044529763187812155; W(r, c++) = 0.31939421508227317;  W(r, c++) =-0.40078901190190425;  W(r, c++) =-0.14074668517876304; W(r, c++) =-0.37681187877076255; W(r, c++) =-0.1377601300551507;   W(r, c++) = 0.44567839149561517; W(r, c++) =-0.079768297825853096; W(r, c++) =-0.082774520203794888; W(r, c++) =-0.053835616050152357; W(r, c++) =-0.49815683938433403; W(r, c++) = 0.26008983672349217; W(r, c++) =-0.39796827177292887; W(r, c++) = 0.41997808785736968;  W(r, c++) = 0.28817742525499013; W(r, c++) =-0.084892599150464265; W(r, c++) = 0.38854504371347653;  W(r, c++) = 0.37314723909179293; W(r, c++) =-0.064729726701831136; W(r, c++) =-0.3038053330833313;   W(r, c++) = 0.11250674789122972;  W(r, c++) = 0.4340763496652581;    W(r, c++) = 0.18050399588172505; W(r, c++) =-0.47117088346190522; W(r, c++) = -0.15605962371844279; W(r, c++) =-0.41852300434452;     W(r, c++) =-0.0099865479763559528; W(r, c++) = 0.10466990219114303;  W(r, c++) = 0.24192155551555827;  W(r, c++) = 0.33179988638735369;  W(r, c++) =-0.47471360257271161;  W(r, c++) = 0.23256059089398828;  W(r, c++) =-0.48736450106926116;   W(r, c++) = 0.32169629869178418; W(r, c++) = 0.17158484579870248;  W(r, c++) =-0.43345490231397116;  W(r, c++) =-0.11733172081684146;  W(r, c++) =-0.36177278591808687;  W(r, c++) = 0.28768139212089539; W(r, c++) = 0.23271895480541605; W(r, c++) =-0.0076868463723303582; W(r, c++) =-0.096221191088938396;  W(r, c++) =-0.15971962074881979;  W(r, c++) = 0.41636156937516;    W(r, c++) = 0.10070299678300032; W(r, c++) = 0.24728195080319604;  W(r, c++) = 0.1050456716470326;   W(r, c++) = 0.28259043717158128; W(r, c++) = 0.11413349806127693;  W(r, c++) = 0.39175426395296797; W(r, c++) =-0.33551400571692119; W(r, c++) =-0.24944194255182356;  W(r, c++) =-0.1718841580897183;   W(r, c++) = 0.42813257009807926; W(r, c++) =-0.44015180943226967;  W(r, c++) = 0.44967867568300202;  W(r, c++) = 0.49854303084311458;  W(r, c++) =-0.043452519097233744; W(r, c++) =-0.42001291286959247;  W(r, c++) =-0.48079919563316215;  W(r, c++) =-0.42257819765637733; W(r, c++) =-0.11234115016391316;
		r =  8; c = 0;
		W(r, c++) =-0.023403045847644133;  W(r, c++) =-0.18985243068066732; W(r, c++) =-0.23950768960804053;  W(r, c++) =-0.17479563725260988;  W(r, c++) =-0.39094215406889626;   W(r, c++) = 0.075651014164888508; W(r, c++) = 0.39817312135787897;  W(r, c++) =-0.04943689336884477;  W(r, c++) =-0.38286570679148196; W(r, c++) = 0.1805891325622565;   W(r, c++) =-0.37610483557556823; W(r, c++) = 0.0036365052098872308; W(r, c++) =-0.44194905617350128; W(r, c++) =-0.18855399899979314;  W(r, c++) =-0.14777443848449251; W(r, c++) =-0.16559830933749836; W(r, c++) =-0.054647810281170106; W(r, c++) = 0.37501633148027114; W(r, c++) = 0.21732414331103722;  W(r, c++) =-0.10330382266909549;  W(r, c++) =-0.48142567245440476;  W(r, c++) = 0.40271015061933069;  W(r, c++) = 0.12053810831655165; W(r, c++) = 0.023050231700098123; W(r, c++) = 0.19959529115061847;  W(r, c++) = 0.249869571783086;   W(r, c++) =-0.23908346455374369;  W(r, c++) =-0.29276802658291706; W(r, c++) =-0.094093116832051071;  W(r, c++) =-0.15977968494896794; W(r, c++) =-0.43364086896221471; W(r, c++) = 0.46859827169270707;   W(r, c++) = 0.035416304328581005; W(r, c++) = 0.0068577868511277007; W(r, c++) = 0.32994068662840603;  W(r, c++) =-0.11331699446676419;  W(r, c++) =-0.0096803224757542883; W(r, c++) = 0.29934121142181402; W(r, c++) = 0.28955872827778317;  W(r, c++) = 0.38877206763198779;  W(r, c++) = 0.27381873247144339;  W(r, c++) =-0.4706224922430135;  W(r, c++) =-0.49281543274772949; W(r, c++) =-0.026629597239888392; W(r, c++) = 0.30439029800010786; W(r, c++) = 0.050777177637437831; W(r, c++) = 0.22818050459967798;  W(r, c++) =-0.10122309487029396;  W(r, c++) = 0.198991711803439;   W(r, c++) =-0.2676372785587548;  W(r, c++) =-0.24739191417528666; W(r, c++) =-0.33644524165918704;  W(r, c++) =-0.20774583188917778; W(r, c++) =-0.023284752004905374; W(r, c++) =-0.48988990600239607;  W(r, c++) = 0.19968580672537095; W(r, c++) =-0.052708104750275153; W(r, c++) = 0.44003464433751038;  W(r, c++) = 0.20492371073993676;  W(r, c++) = 0.080960135568695968;  W(r, c++) = 0.47067579335449572; W(r, c++) =-0.45564747460088301; W(r, c++) =  0.21248039036960897; W(r, c++) =-0.40126956383686468;  W(r, c++) =-0.37191452204839132;   W(r, c++) = 0.036165026086243168; W(r, c++) = 0.015283058794361426; W(r, c++) =-0.25986391257653246;  W(r, c++) =-0.37017714323967271;  W(r, c++) = 0.31617398734159441;  W(r, c++) =-0.2799264076685723;    W(r, c++) = 0.28536875018274888; W(r, c++) =-0.19509758042561615;  W(r, c++) =-0.43759423237347223;  W(r, c++) =-0.090715565600068382; W(r, c++) = 0.36885341750067868;  W(r, c++) = 0.18365922988510708; W(r, c++) =-0.47273281495448821; W(r, c++) =-0.10740675021123941;   W(r, c++) =-0.0039949636820523771; W(r, c++) = 0.47845455135701287;  W(r, c++) = 0.39945353681635698; W(r, c++) = 0.48747102297868927; W(r, c++) =-0.31234541483040107;  W(r, c++) = 0.25475397284803947;  W(r, c++) = 0.29151382402857562; W(r, c++) = 0.30412501663145308;  W(r, c++) =-0.22552734475477326; W(r, c++) = 0.42355928618632122; W(r, c++) = 0.26235240994318165;  W(r, c++) =-0.47569872142305442;  W(r, c++) = 0.34506197239837255; W(r, c++) =-0.37461752524354081;  W(r, c++) =-0.15530164688716425;  W(r, c++) =-0.34480156930780187;  W(r, c++) =-0.26127871265807884;  W(r, c++) =-0.072266954127394645; W(r, c++) = 0.38593851482479236;  W(r, c++) =-0.44599359899232777; W(r, c++) =-0.14239065277349033;
		r =  9; c = 0;
		W(r, c++) = 0.083382039455031198;  W(r, c++) = 0.22983174826012864; W(r, c++) = 0.30502782701302233;  W(r, c++) = 0.37047123210865462;  W(r, c++) = 0.051267246090551222;  W(r, c++) =-0.20967049759724193;  W(r, c++) = 0.42308243982017679;  W(r, c++) = 0.16024537862238897;  W(r, c++) =-0.27953946313217143; W(r, c++) =-0.47330320533779474;  W(r, c++) =-0.2894234901133535;  W(r, c++) =-0.46062129291530757;   W(r, c++) = 0.17620178429937827; W(r, c++) =-0.14284831740973708;  W(r, c++) =-0.21212208514359993; W(r, c++) =-0.26058403981404138; W(r, c++) =-0.24077307655277719;  W(r, c++) = 0.31241493236375906; W(r, c++) =-0.49764243528064606;  W(r, c++) =-0.4186545832317658;   W(r, c++) =-0.45933672632473904;  W(r, c++) = 0.14014119979322415;  W(r, c++) =-0.45879705049379066; W(r, c++) =-0.42913711590565246;  W(r, c++) =-0.073464676455971711; W(r, c++) =-0.43884384345403388; W(r, c++) = 0.27710015450850956;  W(r, c++) =-0.45789857210933799; W(r, c++) = 0.17992948311000223;   W(r, c++) = 0.46256646325468176; W(r, c++) =-0.41535686316692982; W(r, c++) = 0.0049996926056783408; W(r, c++) = 0.09861426366746906;  W(r, c++) =-0.24554060151662066;   W(r, c++) =-0.44447295411033855;  W(r, c++) =-0.45296708418815951;  W(r, c++) = 0.38127661541224134;   W(r, c++) = 0.41688740809100933; W(r, c++) =-0.42466041478143973;  W(r, c++) = 0.27939571069488567;  W(r, c++) = 0.23427934165711584;  W(r, c++) =-0.15212227271566042; W(r, c++) =-0.13086985282997426; W(r, c++) =-0.20736801403502642;  W(r, c++) =-0.18410858133187552; W(r, c++) = 0.24087881987092197;  W(r, c++) =-0.17932899712549605;  W(r, c++) = 0.26764074282127848;  W(r, c++) = 0.1187355180234525;  W(r, c++) = 0.26199501309771167; W(r, c++) =-0.2166034961395113;  W(r, c++) =-0.085169599496267179; W(r, c++) =-0.12819567644422541; W(r, c++) = 0.19469563291644421;  W(r, c++) = 0.026828020653922868; W(r, c++) = 0.2270999543422898;  W(r, c++) = 0.20882775744423798;  W(r, c++) = 0.086530258581020036; W(r, c++) = 0.012118650611431248; W(r, c++) =-0.0097979362699969763; W(r, c++) =-0.10348551304810866; W(r, c++) =-0.13129587411794102; W(r, c++) = -0.4554970986707903;  W(r, c++) = 0.26544137413647528;  W(r, c++) = 0.37109264194217328;   W(r, c++) =-0.23901202326606047;  W(r, c++) = 0.35909581966527071;  W(r, c++) = 0.018153297212112229; W(r, c++) =-0.10441914830175686;  W(r, c++) = 0.25996654022191923;  W(r, c++) = 0.15276342006800492;   W(r, c++) =-0.11590766948628867; W(r, c++) =-0.14364209343796147;  W(r, c++) = 0.47209324437361677;  W(r, c++) =-0.23625909884493362;  W(r, c++) = 0.013934596181302994; W(r, c++) =-0.33168523968910574; W(r, c++) = 0.43242300964503477; W(r, c++) =-0.18923580251379296;   W(r, c++) =-0.47931623255424433;   W(r, c++) = 0.47186655737931849;  W(r, c++) =-0.16934153552192061; W(r, c++) =-0.49898720690354642; W(r, c++) = 0.048877261102780345; W(r, c++) =-0.23424146837444776;  W(r, c++) = 0.34474162761813076; W(r, c++) =-0.27169790938634947;  W(r, c++) = 0.44494501321073388; W(r, c++) = 0.4279862525071727;  W(r, c++) =-0.11337496760776683;  W(r, c++) =-0.026275069110689053; W(r, c++) = 0.44529764373145608; W(r, c++) =-0.36604384399488027;  W(r, c++) = 0.085883355237539205; W(r, c++) = 0.40016238725800035;  W(r, c++) =-0.041329618377515642; W(r, c++) =-0.14767988346312794;  W(r, c++) =-0.30665713515773779;  W(r, c++) =-0.14501970556272697; W(r, c++) =-0.37663437406579653;
		r = 10; c = 0;
		W(r, c++) = 0.40811288519533517;   W(r, c++) = 0.39883828796799348; W(r, c++) = 0.048699303835589292; W(r, c++) =-0.3089329084976094;   W(r, c++) = 0.20656140986688964;   W(r, c++) =-0.3106086714456438;   W(r, c++) = 0.040599924948054422; W(r, c++) = 0.49625783935357271;  W(r, c++) = 0.2945829717105759;  W(r, c++) = 0.13499990991145827;  W(r, c++) = 0.30074659035418094; W(r, c++) =-0.39907875881103333;   W(r, c++) = 0.34542459370161638; W(r, c++) = 0.33766117436897902;  W(r, c++) =-0.14079880274625362; W(r, c++) = 0.13739940112930027; W(r, c++) =-0.34231342787768909;  W(r, c++) =-0.31199870594917195; W(r, c++) = 0.32273141053141574;  W(r, c++) =-0.22528615658073786;  W(r, c++) = 0.18099677011124327;  W(r, c++) =-0.12755073702774394;  W(r, c++) =-0.33613945432442399; W(r, c++) =-0.096830853554906449; W(r, c++) =-0.198096883780644;    W(r, c++) =-0.49214899466874812; W(r, c++) =-0.068778975367955797; W(r, c++) = 0.44796135125631997; W(r, c++) = 0.37765658290109516;   W(r, c++) = 0.39900803803100759; W(r, c++) = 0.36889531400437847; W(r, c++) = 0.4010904768840049;    W(r, c++) = 0.32569661716035381;  W(r, c++) =-0.43437915672726918;   W(r, c++) =-0.46406616656981098;  W(r, c++) =-0.029110790951934751; W(r, c++) = 0.11011974290622339;   W(r, c++) = 0.37253472177346691; W(r, c++) =-0.45535909457558749;  W(r, c++) = 0.19850243273162493;  W(r, c++) =-0.4692991540480938;   W(r, c++) =-0.49003575868703392; W(r, c++) =-0.47534998556384417; W(r, c++) = 0.43712684421546977;  W(r, c++) =-0.25716131004201476; W(r, c++) =-0.35771652615758393;  W(r, c++) =-0.29600972405376597;  W(r, c++) =-0.068283504435887876; W(r, c++) =-0.49222335056413574; W(r, c++) =-0.21991161531161069; W(r, c++) = 0.2552228545587315;  W(r, c++) =-0.21030805049279416;  W(r, c++) = 0.12881090594688616; W(r, c++) =-0.181759823167922;    W(r, c++) =-0.43354317034113693;  W(r, c++) =-0.27331297739833754; W(r, c++) = 0.02416187015229232;  W(r, c++) =-0.45020673494173508;  W(r, c++) =-0.21557600966520168;  W(r, c++) = 0.20411681738236886;   W(r, c++) = 0.42139191345105276; W(r, c++) =-0.29040867187121627; W(r, c++) =  0.43418346011619102; W(r, c++) =-0.085987151531481343; W(r, c++) = 0.43446088844614883;   W(r, c++) =-0.26821212458194471;  W(r, c++) =-0.37820610862452836;  W(r, c++) = 0.17464575415335126;  W(r, c++) = 0.4757565794644123;   W(r, c++) =-0.14653759741411293;  W(r, c++) = 0.16084927975444896;   W(r, c++) =-0.44081969403726301; W(r, c++) = 0.039513305263094378; W(r, c++) =-0.077347106219450124; W(r, c++) = 0.031336678598825052; W(r, c++) = 0.23243484422267668;  W(r, c++) =-0.42151135633008724; W(r, c++) =-0.46368395167332183; W(r, c++) = 0.40054165786674401;   W(r, c++) = 0.239958502320053;     W(r, c++) =-0.29103026452663988;  W(r, c++) = 0.24739491060435859; W(r, c++) =-0.3592412578418645;  W(r, c++) =-0.076120769391155141; W(r, c++) =-0.21503716697070657;  W(r, c++) = 0.25005270921693268; W(r, c++) =-0.4843079569770215;   W(r, c++) = 0.42649671003209022; W(r, c++) = 0.13474893864052184; W(r, c++) = 0.27544672515521318;  W(r, c++) = 0.021692738945334966; W(r, c++) =-0.18519896721356649; W(r, c++) =-0.019107135345689696; W(r, c++) =-0.41720093726568358;  W(r, c++) = 0.052726485973738968; W(r, c++) =-0.34061029024771777;  W(r, c++) =-0.04841936129475094;  W(r, c++) =-0.086163709719531523; W(r, c++) = 0.4018413321683949;  W(r, c++) =-0.14921563102798813;
		r = 11; c = 0;
		W(r, c++) = 0.0046868558173902564; W(r, c++) = 0.18398393191544127; W(r, c++) =-0.48595829983598099;  W(r, c++) = 0.067510740620671861; W(r, c++) = 0.047440911328423763;  W(r, c++) =-0.31327047174444483;  W(r, c++) =-0.10870394976537506;  W(r, c++) = 0.41694121794745609;  W(r, c++) =-0.16746385078034448; W(r, c++) = 0.10633841775421893;  W(r, c++) = 0.43696915864458075; W(r, c++) = 0.48823514872250107;   W(r, c++) =-0.15768745892141595; W(r, c++) =-0.24906733517786289;  W(r, c++) = 0.4469058356578911;  W(r, c++) =-0.1213519296769055;  W(r, c++) = 0.027573130167614646; W(r, c++) = 0.49942035945533036; W(r, c++) = 0.028345976859792787; W(r, c++) =-0.047021815182085647; W(r, c++) = 0.058355736097046917; W(r, c++) = 0.037928783731820515; W(r, c++) = 0.4819140701253054;  W(r, c++) =-0.17147928998451306;  W(r, c++) = 0.2347509912186152;   W(r, c++) =-0.10619204821829048; W(r, c++) =-0.14147961799046099;  W(r, c++) =-0.2841056315346428;  W(r, c++) =-0.0045940750888112114; W(r, c++) = 0.3181183809177941;  W(r, c++) =-0.46058417062197116; W(r, c++) = 0.0024285989524275298; W(r, c++) =-0.017786436934083827; W(r, c++) = 0.35988342212146163;   W(r, c++) =-0.082133955203705422; W(r, c++) =-0.34863224610516369;  W(r, c++) =-0.032811584961929652;  W(r, c++) = 0.18100644635705698; W(r, c++) = 0.43428958237156767;  W(r, c++) =-0.079888883925179177; W(r, c++) =-0.053281400866163453; W(r, c++) = 0.47432351284096785; W(r, c++) = 0.10484823758053108; W(r, c++) = 0.45814789498749753;  W(r, c++) = 0.25485841321903779; W(r, c++) =-0.077811253830581129; W(r, c++) =-0.20668834483369486;  W(r, c++) =-0.25204233110299484;  W(r, c++) =-0.20143987898187915; W(r, c++) = 0.48401513711824551; W(r, c++) = 0.40877432522200707; W(r, c++) = 0.019834102201614634; W(r, c++) =-0.34293003288434282; W(r, c++) = 0.15205448089854834;  W(r, c++) = 0.36710977614948825;  W(r, c++) = 0.25161393413581201; W(r, c++) =-0.37077696465800641;  W(r, c++) =-0.1116524038219508;   W(r, c++) = 0.37745745392852792;  W(r, c++) =-0.28458040701453197;   W(r, c++) =-0.04629582768046675; W(r, c++) = 0.02451460321059229; W(r, c++) = -0.42766226821237457; W(r, c++) = 0.41923415819903109;  W(r, c++) =-0.18040300164618234;   W(r, c++) =-0.38126976329928891;  W(r, c++) = 0.14519696140650518;  W(r, c++) =-0.26639682521524338;  W(r, c++) = 0.010474517876123191; W(r, c++) = 0.091028050575708619; W(r, c++) =-0.0053010597136868287; W(r, c++) =-0.46171213451655718; W(r, c++) = 0.2323138239267305;   W(r, c++) = 0.39242893399285916;  W(r, c++) = 0.2356369121419466;   W(r, c++) =-0.3518321135666414;   W(r, c++) = 0.42764942992228894; W(r, c++) =-0.41038068116929255; W(r, c++) = 0.050448450959604374;  W(r, c++) =-0.46572645564436926;   W(r, c++) = 0.066038235885829355; W(r, c++) =-0.49090787332555136; W(r, c++) =-0.45639861790918651; W(r, c++) = 0.44978804759788804;  W(r, c++) =-0.071296358268475413; W(r, c++) =-0.34466698181145289; W(r, c++) = 0.029094897073142167; W(r, c++) =-0.42207547595247202; W(r, c++) = 0.44039082729706724; W(r, c++) = 0.12564249093142477;  W(r, c++) =-0.45841374932615436;  W(r, c++) = 0.40526738856189426; W(r, c++) = 0.14189338472689483;  W(r, c++) = 0.059796587932298695; W(r, c++) =-0.46139885758948246;  W(r, c++) =-0.1663340932677036;   W(r, c++) = 0.33350982053626654;  W(r, c++) =-0.4379606939938519;   W(r, c++) = 0.25646770191064616; W(r, c++) =-0.32291312214908513;
	}

	// Q = eye(nx, nx);
	matrix_type Q(ublas::identity_matrix<real_type>(nx,nx));

	// R = eye(nu, nu);
	matrix_type R(ublas::identity_matrix<real_type>(nu,nu));

	// Qf = Q
	matrix_type Qf(Q);

	vector_type xmin(nx, -4);

	vector_type xmax(nx, 4);

	vector_type umin(nu, -0.5);

	vector_type umax(nu, 0.5);

	vector_type x0(nx, 0);

	size_type niters = 5;
	size_type T = 10;
	real_type kappa = 0.01;

	matrix_type X(nx, T, 0);
	matrix_type U(nu, T, 0);
	vector_type x(x0);

	matrix_type Xhist(nx, nsteps, 0); // state
	matrix_type Uhist(nu, nsteps, 0); // input
	vector_type Jhist(nsteps, 0); // stage cost
	vector_type thist(nsteps, 0); // fmpc runtime

	dcs::control::fmpc_controller<real_type,size_type> fmpc(A, B, Q, R, Qf, xmin, xmax, umin, umax, T, kappa, niters, X, U);

	size_type n = nsteps;
	for (size_type k = 0; k < n; ++k)
	{
		std::cout << "--- MPC STEP #" << (k+1) << std::endl;

		vector_type u;

		u = fmpc.control(x);
		//std::cerr << "u=" << u << std::endl;

		// record state, input, stage cost, and fmpc run time
		ublas::column(Xhist, k) = x;
		ublas::column(Uhist, k) = u;
		vector_type xtQ(ublas::prod(x, Q));
		vector_type utR(ublas::prod(u, R));
		Jhist(k) = ublas::inner_prod(xtQ, x) + ublas::inner_prod(utR, u);
		//thist(k) = telapsed;

		// state update
		vector_type Ax;
		Ax = ublas::prod(A, x);
		vector_type Bu;
		Bu = ublas::prod(B, u);
		x = Ax+Bu+ublas::column(W, k);
		//std::cerr << "x=" << x << std::endl;

//		// shift previous state and input trajectories
//		// for warm start in next step
//		X = ublasx::cat_rows(ublas::subrange(X, 0, nx, 1, T), ublas::zero_matrix<real_type>(nx, 1));
//		//std::cerr << "New X=" << X << std::endl;
//		U = ublasx::cat_rows(ublas::subrange(U, 0, nu, 1, T), ublas::zero_matrix<real_type>(nu, 1));
//		//std::cerr << "New U=" << U << std::endl;
	}

	std::cout << std::endl << "The average cost is: " << ublas::sum(Jhist)/nsteps << std::endl;
}

int main()
{
	DCS_TEST_SUITE("DCS Control :: Fast-MPC");

	DCS_TEST_BEGIN();

	DCS_TEST_DO( free_func );
	DCS_TEST_DO( oo );

    DCS_TEST_END();
}
